---
import SectionHeading from '../components/ui/SectionHeading.astro';
import BaseLayout from '../layouts/BaseLayout.astro';
import { env } from '../lib/env';

const { githubSupportUrl } = env;
const issueUrl = `${githubSupportUrl}/new?title=%5BIssue%5D%20Describe%20the%20problem&labels=bug&template=bug_report.yml`;
---
<BaseLayout title="Troubleshooting Winterlands" description="Resolve crashes, mod conflicts, and exports with clear steps.">
  <section class="mx-auto max-w-6xl px-6 py-16 space-y-10">
    <SectionHeading
      eyebrow="Support"
      title="Troubleshooting & Reporting Issues"
      description="Follow the checklists below before opening an issue. Crash Assistant will guide you if the game hard-crashes."
    />

    <div class="grid gap-6 md:grid-cols-2">
      <article class="frosted-panel p-6">
        <h3 class="font-display text-2xl text-white">Quick triage</h3>
        <ul class="mt-4 space-y-3 text-white/75">
          <li>1) Update to the latest pack zip and <code>packwiz refresh</code> if you maintain a fork.</li>
          <li>2) Remove any custom mods you added; re-test with the stock modpack.</li>
          <li>3) Clear shader/resourcepack overrides to rule out bad assets.</li>
          <li>4) Ensure Java 21+ and at least 6–8 GB RAM allocated.</li>
        </ul>
      </article>

      <article class="frosted-panel p-6">
        <h3 class="font-display text-2xl text-white">Mod incompatibilities</h3>
        <p class="mt-2 text-white/70">
          If you added mods yourself and see crashes or missing textures:
        </p>
        <ul class="mt-3 space-y-2 text-white/75">
          <li>• Reproduce the issue with only your added mod + stock pack.</li>
          <li>• Capture latest <code>logs/latest.log</code> and <code>crash-reports/*</code> if present.</li>
          <li>• Note the exact mod name, version, and steps to trigger the problem.</li>
        </ul>
        <p class="mt-3 text-white/70">Post these details to us via GitHub issues (button below).</p>
      </article>

      <article class="frosted-panel p-6">
        <h3 class="font-display text-2xl text-white">When the game hard-crashes</h3>
        <p class="mt-2 text-white/70">
          Crash Assistant will open with instructions. Follow it to gather:
        </p>
        <ul class="mt-3 space-y-2 text-white/75">
          <li>• <code>latest.log</code> and any other log files.</li>
          <li>• The Crash Assistant summary text or screenshot.</li>
          <li>• Steps to reproduce.</li>
        </ul>
        <p class="mt-3 text-white/70">
          Attach these to the GitHub issue. If Crash Assistant didn’t appear, copy the crash report from
          <code>crash-reports</code>.
        </p>
      </article>

      <article class="frosted-panel p-6">
        <h3 class="font-display text-2xl text-white">Server</h3>
        <ul class="mt-3 space-y-2 text-white/75">
          <li>• Make sure you are running only server-side mods or mods marked as both</li>
          <li>• Your server should at least have 6–8 GB RAM allocated.</li>
          <li>• If you cannot resolve the issue that way, open an issue with the crash report or log file.</li>
        </ul>
      </article>
    </div>

    <div class="rounded-3xl border border-white/10 bg-white/5 p-6 shadow-[0_35px_70px_rgba(1,8,16,0.45)]">
      <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
        <div>
          <h3 class="font-display text-2xl text-white">Open a GitHub issue</h3>
          <p class="mt-2 text-white/70">
            Include: Crash Assistant output, <code>latest.log</code>, and any custom mods you added.
          </p>
        </div>
        <a
          href={issueUrl}
          class="inline-flex items-center gap-2 rounded-full border border-white/15 bg-[#0f1116] px-5 py-2 text-sm font-semibold text-white shadow-[0_10px_25px_rgba(0,0,0,0.45)] transition hover:-translate-y-0.5 hover:border-white/25 hover:bg-[#161921] focus:outline-2 focus:outline-offset-2 focus:outline-white/50"
          target="_blank"
          rel="noreferrer noopener"
        >
          <span class="inline-flex h-5 w-5 items-center justify-center rounded-full bg-white text-[#0f1116]">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 .5C5.65.5.5 5.65.5 12a11.5 11.5 0 0 0 7.86 10.92c.58.11.79-.25.79-.55v-1.92c-3.2.7-3.87-1.54-3.87-1.54-.53-1.36-1.3-1.73-1.3-1.73-1.06-.73.08-.72.08-.72 1.17.08 1.78 1.2 1.78 1.2 1.04 1.78 2.73 1.26 3.4.96.1-.76.41-1.26.75-1.55-2.55-.29-5.23-1.28-5.23-5.7 0-1.26.45-2.3 1.2-3.11-.12-.3-.52-1.5.12-3.12 0 0 .98-.31 3.2 1.19a11 11 0 0 1 5.82 0c2.22-1.5 3.2-1.19 3.2-1.19.64 1.62.24 2.82.12 3.12.75.81 1.2 1.85 1.2 3.1 0 4.43-2.69 5.41-5.25 5.7.42.37.8 1.1.8 2.23v3.31c0 .31.21.67.8.55A11.5 11.5 0 0 0 23.5 12C23.5 5.65 18.35.5 12 .5Z"/>
            </svg>
          </span>
          <span class="font-medium">Create an Issue on</span>
          <span class="font-bold">GitHub</span>
        </a>
      </div>
    </div>
  </section>
</BaseLayout>
