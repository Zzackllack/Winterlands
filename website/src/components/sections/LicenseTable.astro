---
import type { CollectionEntry } from 'astro:content';
import { sortLicenses } from '../../lib/data';

interface Props {
  licenses: CollectionEntry<'licenses'>[];
}

const { licenses } = Astro.props as Props;
const entries = sortLicenses(licenses);
---
<div class="overflow-hidden rounded-3xl border border-white/10">
  <table class="w-full border-collapse text-sm">
    <thead class="bg-white/10 text-white/70">
      <tr>
        <th class="px-4 py-3 text-left font-semibold">Mod</th>
        <th class="px-4 py-3 text-left font-semibold">License</th>
        <th class="px-4 py-3 text-left font-semibold">Permissions</th>
        <th class="px-4 py-3 text-left font-semibold">Restrictions</th>
      </tr>
    </thead>
    <tbody>
      {entries.map((entry) => (
        <tr class="odd:bg-white/5 even:bg-white/0">
          <td class="px-4 py-4">
            <p class="font-medium text-white">{entry.data.mod}</p>
            {entry.data.source && (
              <a href={entry.data.source} class="text-xs text-white/60" target="_blank" rel="noreferrer">
                Source →
              </a>
            )}
          </td>
          <td class="px-4 py-4 text-white/80">{entry.data.license}</td>
          <td class="px-4 py-4">
            <ul class="space-y-1 text-white/70">
              {entry.data.permissions.map((rule) => (
                <li>• {rule}</li>
              ))}
            </ul>
          </td>
          <td class="px-4 py-4">
            <ul class="space-y-1 text-red-200/80">
              {entry.data.restrictions.map((rule) => (
                <li>• {rule}</li>
              ))}
            </ul>
          </td>
        </tr>
      ))}
    </tbody>
  </table>
</div>
